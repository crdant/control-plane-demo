#!/usr/bin/env bash
# Pre-commit hook to format code automatically

set -e

echo "ğŸ”§ Running code formatter..."

# Run make format to automatically format code
if ! make format; then
    echo "âŒ Code formatting failed"
    exit 1
fi

# Check if any files were modified by formatting
if ! git diff --quiet; then
    echo "ğŸ“ Code was automatically formatted. Staging changes..."
    
    # Get list of files that were modified
    modified_files=$(git diff --name-only)
    
    # Add the formatted files back to staging
    git add $modified_files
    
    echo "âœ… Formatted files have been staged:"
    echo "$modified_files"
    echo ""
    echo "ğŸ’¡ Your commit will include the formatted changes."
else
    echo "âœ… Code is already properly formatted"
fi

echo "ğŸš€ Pre-commit checks passed!"